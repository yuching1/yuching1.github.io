<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>台灣感性 Landing Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body, html { font-family:'Noto Sans TC', sans-serif; background-color: rgb(233,217,194); overflow-x:hidden; }

    header {
      position: fixed; top:0; width:100%; background: rgba(236,199,109,0.95); padding:15px;
      display:flex; justify-content:center; gap:30px; z-index:100; backdrop-filter: blur(10px);
    }
    header div { cursor:pointer; font-weight:bold; font-size:16px; transition:color 0.3s; }
    header div:hover { color: rgb(101,132,101); }

    #map-section, #map {
      width: 100%;
      height: 100vh;
      position: relative;
    }

    .photo {
      position: absolute;
      width:220px; height:147px;
      border:5px solid rgb(101,132,101);
      border-radius:12px;
      box-shadow:0 10px 30px rgba(0,0,0,0.4);
      object-fit:cover;
      opacity:0;
      transform: translateY(50px) scale(0.8);
      pointer-events:none;
      z-index:10;
    }

    #scroll-hint {
      position:absolute; bottom:40px; left:50%; transform:translateX(-50%);
      color:white; background: rgba(101,132,101,0.9); padding:12px 24px; border-radius:20px;
      font-weight:600; z-index:20; animation: bounce 2s infinite;
    }
    @keyframes bounce {
      0%,100%{transform:translateX(-50%) translateY(0);}
      50%{transform:translateX(-50%) translateY(-10px);}
    }

    section.next-section {
      height:100vh; background-color: rgb(236,199,109);
      display:flex; align-items:center; justify-content:center;
      font-size:2.5rem; font-weight:bold; color: rgb(101,132,101);
    }
  </style>
</head>
<body>
  <header>
    <div>序章</div>
    <div>感性生成的地方</div>
    <div>審美差異與對話</div>
    <div>再生與未來可能</div>
    <div>結語</div>
  </header>

  <section id="map-section">
    <div id="map"></div>
    <div id="scroll-hint">⬇ 向下滾動探索台灣</div>
  </section>

  <section class="next-section">
    下一個段落：感性生成的地方
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
  <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>

  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoicjEyMjI3MTA2IiwiYSI6ImNtaHJneXdqbDBxbjkyaXM3bnJiOTFraHcifQ.BZIX8VBFwjl65YN9CiM6Hw';

    const map = new mapboxgl.Map({
      container:'map',
      style:'mapbox://styles/mapbox/streets-v12',
      center:[120.9,23.8],
      zoom:4.2 // 初始看到整個台灣
    });

    // 調整順序: 全台 → 台北 → 澎湖 → 台中 → 花蓮 → 台南
    const locations = [
      { name:'全台', coords:[120.9,23.8], zoom:4.2, img:null },
      { name:'台北', coords:[121.5654,25.0330], zoom:8, img:'images/taipei.jpg' },
      { name:'澎湖', coords:[119.5793,23.5711], zoom:8, img:'images/penghu.jpg' },
      { name:'台中', coords:[120.6736,24.1477], zoom:8, img:'images/taichung.jpg' },
      { name:'花蓮', coords:[121.6015,23.9937], zoom:8, img:'images/hualien.jpg' },
      { name:'台南', coords:[120.2513,22.9908], zoom:8, img:'images/tainan.jpg' }
    ];

    const photoContainer = document.createElement('div');
    photoContainer.style.position='absolute';
    photoContainer.style.top='50%';
    photoContainer.style.left='50%';
    photoContainer.style.transform='translate(-50%, -50%)';
    document.getElementById('map-section').appendChild(photoContainer);

    const photos = {};
    locations.forEach(loc=>{
      if(loc.img){
        const img = document.createElement('img');
        img.src = loc.img;
        img.className = 'photo';
        photoContainer.appendChild(img);
        photos[loc.name] = img;
      }
    });

    gsap.registerPlugin(ScrollTrigger);

    ScrollTrigger.create({
      trigger:'#map-section',
      start:'top top',
      end:'bottom top',
      scrub:1,
      pin:true,
      onUpdate:self=>{
        const progress = self.progress;
        const total = locations.length;

        locations.forEach((loc,index)=>{
          const start = index/total;
          const end = (index+1)/total;
          const t = (progress-start)/(end-start);

          if(t>0 && t<=1){
            // 平滑過渡到指定中心和 zoom
            map.easeTo({
              center: loc.coords,
              zoom: loc.zoom,
              duration: 0.8, // 平滑效果
              easing: (t)=>t // 線性 easing
            });

            if(loc.img){
              const el = photos[loc.name];
              el.style.opacity = t;
              el.style.transform = `translate(-50%, calc(-50% + ${50*(1-t)}px)) scale(${0.8+1*t})`;
            }
          } else {
            if(loc.img){
              photos[loc.name].style.opacity = 0;
            }
          }
        });
      }
    });
  </script>
</body>
</html>
